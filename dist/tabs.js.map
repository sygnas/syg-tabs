{"version":3,"file":"tabs.js","sources":["../src/index.js"],"sourcesContent":["/**\r\n * Easy tab controll\r\n *\r\n * @author   Hiroshi Fukuda <info.sygnas@gmail.com>\r\n * @license  MIT\r\n */\r\n\r\n// デフォルト設定\r\nconst defaults = {\r\n    // タブボタンのセレクタ\r\n    tab_selector: 'a',\r\n    // URLハッシュに対応するか\r\n    use_url_hash: false\r\n};\r\n\r\n// data属性：コンテンツ\r\nconst DATA_CONTENT = 'data-tabs-content';\r\n// data属性：前のボタン\r\nconst DATA_PREV = 'data-tabs-prev';\r\n// data属性：次のボタン\r\nconst DATA_NEXT = 'data-tabs-next';\r\n// data属性：初期ページ番号\r\nconst DATA_INITIAL = 'data-tabs-initial';\r\n// data属性：アクティブボタン / アクティブコンテンツ\r\nconst DATA_ACTIVE = 'data-tabs-active';\r\n\r\n\r\n\r\nexport default class {\r\n\r\n    /**\r\n     * コンストラクタ\r\n     * @param {String} target タブボタングループのDOMセレクタ\r\n     */\r\n    constructor(target, options) {\r\n        // 設定\r\n        this.opt = Object.assign(defaults, options);\r\n\r\n        // タブグループのエレメント\r\n        this.tab_group = document.querySelector(target);\r\n        // 個々のタブボタン\r\n        this.tab_buttons = this.tab_group.querySelectorAll(\r\n            this.opt.tab_selector\r\n        );\r\n        // コンテンツ\r\n        this.contents = document.querySelectorAll(\r\n            this.tab_group.getAttribute(DATA_CONTENT)\r\n        );\r\n        // 戻るボタン\r\n        this.prev_button = document.querySelector(\r\n            this.tab_group.getAttribute(DATA_PREV)\r\n        );\r\n        // 進むボタン\r\n        this.next_button = document.querySelector(\r\n            this.tab_group.getAttribute(DATA_NEXT)\r\n        );\r\n\r\n        // イベント設定\r\n        this._init_event();\r\n\r\n        // 現在表示しているページを取得\r\n        this.active = 0;\r\n        this._set_initial_page();\r\n    }\r\n\r\n    /**\r\n     * 指定した index のタブをアクティブにする\r\n     * @param {Number} index タブ番号\r\n     */\r\n    set_active_from_index(index) {\r\n        // タブボタンとコンテンツにアクティブ属性付与\r\n        get_node_array(this.tab_buttons).forEach((btn, i) => {\r\n            if (index === i) {\r\n                btn.setAttribute(DATA_ACTIVE, 'true');\r\n            } else {\r\n                btn.setAttribute(DATA_ACTIVE, 'false');\r\n            }\r\n        });\r\n\r\n        get_node_array(this.contents).forEach((content, i) => {\r\n            if (index === i) {\r\n                content.setAttribute(DATA_ACTIVE, 'true');\r\n            } else {\r\n                content.setAttribute(DATA_ACTIVE, 'false');\r\n            }\r\n        });\r\n\r\n        // URLにハッシュ付与\r\n        if (this.opt.use_url_hash) {\r\n            window.location.hash = index;\r\n        }\r\n        this.active = index;\r\n    }\r\n\r\n    /**\r\n     * イベント設定\r\n     */\r\n    _init_event() {\r\n\r\n        // タブボタンをクリック\r\n        // 指定されたページをアクティブにする\r\n        get_node_array(this.tab_buttons).forEach((elm) => {\r\n            this._init_event_tab_button(elm);\r\n        });\r\n\r\n        // 戻るボタン\r\n        if (this.prev_button) {\r\n            this.prev_button.addEventListener('click', (e) => {\r\n                this._init_event_prev_button(e);\r\n            });\r\n        }\r\n\r\n        // 進むボタン\r\n        if (this.next_button) {\r\n            this.next_button.addEventListener('click', (e) => {\r\n                this._init_event_next_button(e);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * タブボタンのイベント\r\n     * @param elm {DOM} ボタンエレメント\r\n     */\r\n    _init_event_tab_button(elm) {\r\n        elm.addEventListener('click', (e) => {\r\n            const index = Number.parseInt(e.target.hash.substr(1), 10);\r\n            this.set_active_from_index(index);\r\n            e.preventDefault();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 戻るボタンのイベント\r\n     * @param e {Event} クリックイベント\r\n     */\r\n    _init_event_prev_button(e) {\r\n        const index = this.active - 1 >= 0 ?\r\n            this.active - 1 : this.contents.length - 1;\r\n        this.set_active_from_index(index);\r\n        e.preventDefault();\r\n    }\r\n\r\n    /**\r\n     * 進むボタンのイベント\r\n     * @param e {Event} クリックイベント\r\n     */\r\n    _init_event_next_button(e) {\r\n        const index = (this.active + 1) % this.contents.length;\r\n        this.set_active_from_index(index);\r\n        e.preventDefault();\r\n    }\r\n\r\n    /**\r\n     * 初期表示ページを設定する\r\n     */\r\n    _set_initial_page() {\r\n        let page_index = 0;\r\n\r\n        // まずはhtml側で指定された初期ページ番号を取得\r\n        page_index = Number.parseInt(\r\n            this.tab_group.getAttribute(DATA_INITIAL), 10\r\n        ) || 0;\r\n\r\n        // URLパラメーターが有効だった場合\r\n        if (this.opt.use_url_hash) {\r\n            const hash = window.location.hash.substr(1);\r\n            const index = Number.parseInt(hash, 10);\r\n\r\n            // 1以上だったらページ指定\r\n            if (index >= 1) {\r\n                page_index = index;\r\n            }\r\n        }\r\n\r\n        // ページをアクティブにする\r\n        this.set_active_from_index(page_index);\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * NodeListをArrayとして取り出す（IE対策）\r\n */\r\nfunction get_node_array(node_list) {\r\n    return Array.prototype.slice.call(node_list, 0);\r\n}\r\n"],"names":["defaults","DATA_CONTENT","DATA_PREV","DATA_NEXT","DATA_INITIAL","DATA_ACTIVE","target","options","opt","Object","assign","tab_group","document","querySelector","tab_buttons","querySelectorAll","tab_selector","contents","getAttribute","prev_button","next_button","_init_event","active","_set_initial_page","index","forEach","btn","i","setAttribute","content","use_url_hash","location","hash","elm","_init_event_tab_button","addEventListener","e","_init_event_prev_button","_init_event_next_button","Number","parseInt","substr","set_active_from_index","preventDefault","length","page_index","window","get_node_array","node_list","Array","prototype","slice","call"],"mappings":"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"}